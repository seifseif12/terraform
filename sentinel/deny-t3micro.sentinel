import "tfplan/v2" as tfplan
import "strings"

main = rule {
  all tfplan.resources.aws_instance as _, instances {
    all instances as inst {
      # Only check instance_type if it's set in the applied plan
      not inst.applied contains "instance_type" or
      strings.lower(inst.applied.instance_type) != "t3.micro"
    }
  }
}
